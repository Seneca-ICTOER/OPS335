<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-A-Labs/lab7">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="icon" href="/OPS335/img/pwa/icon-512x512.png">
<link rel="manifest" href="/OPS335/manifest.json">
<meta name="theme-color" content="#DA291C">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#DA291C">
<link rel="apple-touch-icon" href="/OPS335/img/pwa/icon-192x192.png">
<link rel="mask-icon" href="/OPS335/img/pwa/icon-512x512.png" color="#DA291C">
<meta name="msapplication-TileImage" content="/OPS335/img/pwa/icon-512x512.png">
<meta name="msapplication-TileColor" content="#DA291C">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Lab 7 | OPS335 - Open System Application Server</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://Seneca-ICTOER.github.io//OPS335/A-Labs/lab7"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lab 7 | OPS335 - Open System Application Server"><meta data-rh="true" name="description" content="Lab 7"><meta data-rh="true" property="og:description" content="Lab 7"><link data-rh="true" rel="icon" href="/OPS335/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://Seneca-ICTOER.github.io//OPS335/A-Labs/lab7"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//OPS335/A-Labs/lab7" hreflang="en"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//OPS335/A-Labs/lab7" hreflang="x-default"><link rel="stylesheet" href="/OPS335/assets/css/styles.099fe1a9.css">
<link rel="preload" href="/OPS335/assets/js/runtime~main.78245959.js" as="script">
<link rel="preload" href="/OPS335/assets/js/main.293728ce.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/OPS335/"><div class="navbar__logo"><img src="/OPS335/img/logo.svg" alt="Seneca College" class="themedImage_ToTc themedImage--light_HNdA"><img src="/OPS335/img/logo-dark.svg" alt="Seneca College" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">OPS335 - Open System Application Server</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/OPS335/">Welcome to OPS335</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/OPS335/weekly-schedule">Weekly Schedule</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/OPS335/A-Labs/installation-lab0">Labs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS335/A-Labs/installation-lab0">Installation Prep Lab 0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS335/A-Labs/lab1">Lab 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS335/A-Labs/lab2a">Lab 2a</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS335/A-Labs/lab2b">Lab 2b</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS335/A-Labs/lab3">Lab 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS335/A-Labs/lab4a">Lab 4a</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS335/A-Labs/lab4b">Lab 4b</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS335/A-Labs/lab5">Lab 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS335/A-Labs/lab6">Lab 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/OPS335/A-Labs/lab7">Lab 7</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS335/A-Labs/lab8">Lab 8</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/OPS335/B-Assignments/assignment1-part1">Assignments</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/OPS335/C-ExtraResources/resources">Extra Resources</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/OPS335/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Labs</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lab 7</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lab 7 - Encrypted connections and webmail</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="objective-and-preparation">Objective and Preparation<a class="hash-link" href="#objective-and-preparation" title="Direct link to heading">​</a></h2><p><strong>Prerequistites:</strong> This lab depends on changes made in several previous labs. You must have successfully completed labs 3, 4a, 4b, and 6 in order to be able to do this lab.</p><p>Below is the same diagram that we referred to over the previous 2 email labs:</p><p><img loading="lazy" alt="Email Servers" src="/OPS335/assets/images/Email-servers-a743910280dcb75edc5d46c6f7f1c345.png" width="800" height="580" class="img_ev3q"></p><p>Note the two globes in the above diagram. Those globes represent the Internet that your emails travel through in order to be received by an e-mail recipient. The <strong>smaller globe (the one your workstation is connected to) cannot be trusted to send mail messages unencrypted</strong>. The <strong>larger globe usually involves inter-ISP traffic, often through an internet trunk line, so it is also unencrypted, but it cannot be easily accessed by hackers, pen-testers, or evildoers</strong>.</p><p>There are <strong>two important general truths you need to understand about email encryption</strong>:</p><ul><li><strong>Email (the way the vast majority of people use it) travels from SMTP server to SMTP server uncencrypted.</strong><ul><li>That means that nothing sent over email is truly secure. But attempting to continually intercept SMTP server to SMTP server traffic is difficult and expensive, not worth doing for the little bit of money most of us have in our bank account.</li></ul></li><li><strong>Email travelling over a LAN (especially Wifi, but any local network) is always encrypted.</strong><ul><li>If e-mail traffic on a LAN was not encrypted, it would be easy and inexpensive to intercept (in order to obtain your username and password). These days, unencrypted connections from your client to your SMTP/IMAP/POP3 server very rarely exist.</li></ul></li></ul><p>You see in our diagram that one of the SMTP connections is supposed to be encrypted (this is the one that would be &quot;LAN&quot; traffic) and the IMAP connection as well (this one is either LAN-like traffic or is connecting to localhost, which is a different scenario altogether).</p><p>We&#x27;re going to secure the two connections that we left to be in plain text previously. Unfortunately encrypting things is rarely a straighforward process. Fortunately we have a whole week to spend on it.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="online-resources">Online Resources<a class="hash-link" href="#online-resources" title="Direct link to heading">​</a></h3><ul><li><a href="https://en.wikipedia.org/wiki/Transport_Layer_Security" target="_blank" rel="noopener noreferrer">TSL, SSL Definition</a></li><li><a href="https://www.e-rave.nl/create-a-self-signed-ssl-key-for-postfix" target="_blank" rel="noopener noreferrer">Create a self signed SSL key for Postfix</a></li><li><a href="http://wiki2.dovecot.org/SSL/DovecotConfiguration" target="_blank" rel="noopener noreferrer">Dovecot SSL configuration</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-1-generating-a-self-signed-certificate">Investigation 1: Generating A Self-Signed Certificate<a class="hash-link" href="#investigation-1-generating-a-self-signed-certificate" title="Direct link to heading">​</a></h2><p><strong>Transport Layer Security</strong> (TLS) and its predecessor, <strong>Secure Sockets Layer</strong> (SSL), both of which are frequently referred to as &#x27;SSL&#x27;, are cryptographic protocols designed to provide communications security over a computer network.</p><p>Normally (in production), you would need to pay a &quot;certificate authority&quot; to issue a <strong>certificate</strong> for you. That is essentially <strong>a &quot;signed&quot; public key</strong> that will tell strangers on the internet that your server is really yours (i.e. the certificate authority says so). There is an obvious problem with the previous statement but that is mainly how public key encryption works on the Internet today.</p><p>We will be generating our own public keys, mainly in order to avoid paying for a certificate. We will not have enough time to get into the details of what all the following commands do in this section. They are from <a href="https://www.e-rave.nl/create-a-self-signed-ssl-key-for-postfix" target="_blank" rel="noopener noreferrer">this blog post</a>. If you don&#x27;t understand what the blog post refers to but would like to understand in more details, a good recommended book for interest, called Crypto by Steven Levy, provides a more in-depth discussion of encryption and security.</p><p>The public key cryptography concepts in this lab are the same in a previous lab (<a href="http://zenit.senecac.on.ca/wiki/index.php/OPS335_Lab_1#SSH_Keys" target="_blank" rel="noopener noreferrer">Lab1: SSH</a>), although the terminology is slightly different.</p><p>A simple way to summarize the differences is:</p><ul><li>The <strong>.key</strong> file is your private key.</li><li>The <strong>.crt</strong> file is your public key.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="encrypting-postfix-with-transport-layer-security-tls">Encrypting Postfix with Transport Layer Security (TLS)<a class="hash-link" href="#encrypting-postfix-with-transport-layer-security-tls" title="Direct link to heading">​</a></h3><p><strong>Perform the following steps:</strong></p><ol><li>Let&#x27;s start with the &quot;sending&quot; SMTP server we have <strong>on VM2</strong>. Run the following, replacing andrewsmith.ops with <strong>your domain name</strong>:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> -p /root/postfix-keys /etc/ssl/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">private,certs</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /root/postfix-keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -des3 -out vm2.andrewsmith.ops.key </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> vm2.andrewsmith.ops.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -key vm2.andrewsmith.ops.key -out vm2.andrewsmith.ops.csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -req -days </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> -in vm2.andrewsmith.ops.csr -signkey vm2.andrewsmith.ops.key -out vm2.andrewsmith.ops.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa -in vm2.andrewsmith.ops.key -out vm2.andrewsmith.ops.key.nopass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> vm2.andrewsmith.ops.key.nopass vm2.andrewsmith.ops.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -x509 -extensions v3_ca -keyout cakey.pem -out cacert.pem -days </span><span class="token number" style="color:#36acaa">3650</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> vm2.andrewsmith.ops.key cakey.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> vm2.andrewsmith.ops.key cakey.pem /etc/ssl/private</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> vm2.andrewsmith.ops.crt cacert.pem /etc/ssl/certs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>NOTE</strong>: Those commands will create a certificate, a certificate signing request, a certificate authority, and sign your certificate with your certificate authority. This would be the same as in the real world except there you would contact a real CA, here you&#x27;re making up your own.</li></ul><ol start="2"><li>Now, configure Postfix to use the generated certificate, by adding the following to your <strong>main.cf</strong> file:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Settings to enable secure SMTP using my self-signed certificate:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtpd_tls_auth_only </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtpd_use_tls </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">yes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtp_use_tls </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">yes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtpd_tls_key_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> /etc/ssl/private/vm2.andrewsmith.ops.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtpd_tls_cert_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> /etc/ssl/certs/vm2.andrewsmith.ops.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtpd_tls_CAfile </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> /etc/ssl/certs/cacert.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tls_random_source </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dev:/dev/urandom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtpd_tls_loglevel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-and-testing-encryption-with-thunderbird">Setting Up and Testing Encryption with Thunderbird<a class="hash-link" href="#setting-up-and-testing-encryption-with-thunderbird" title="Direct link to heading">​</a></h3><p><strong>Perform the following steps:</strong></p><ol><li>Currently your Thunderbird is set up to use <strong>vm2.yoursenecaid.ops</strong> for an SMTP server, with no security. Change that to use <strong>STARTTLS</strong> instead (you can change it under <strong>account settings --<!-- -->&gt;<!-- --> Outgoing Server</strong>).</li><li>We haven&#x27;t set up any user authentication, just an encrypted channel; therefore, leave the <strong>authentication method</strong> at the value: <strong>none</strong>.</li><li>When you try to send an email Thunderbird will warn you about the self-signed certificate. You obviously know it&#x27;s your certificate so you can tell Thunderbird to trust it:</li></ol><p><img loading="lazy" alt="SMTP Certificate Warning" src="/OPS335/assets/images/SMTP-certificate-warning-826d94bacc9489164a82dd3a582ee8dd.png" width="506" height="510" class="img_ev3q"></p><ul><li><strong>NOTE</strong>: Your message may look slightly different (This author, that created the diagram above, made a little mistake when generating the certificate).</li></ul><ol start="4"><li>After you confirm that security exception, send another email to yourself and make sure you receive it.</li><li>Notice that from the user&#x27;s point of view nothing is different. But if you were an evildoer trying to steal an identity (the difference is huge). Before it was trivial and now it&#x27;s computationally prohibitive.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="encryption-dovecot-with-secure-socket-layer-ssl">Encryption Dovecot with Secure Socket layer (SSL)<a class="hash-link" href="#encryption-dovecot-with-secure-socket-layer-ssl" title="Direct link to heading">​</a></h3><p>Now we will ensure that our <strong>Dovecot</strong> connection is secure, and enforce that policy. With SMTP, you will need to allow plain text connections since that is the only method to pass email from server-to-server. With IMAP, there is no server-to-server interaction, but rather only client-to-server interaction. The reason to have an unencrypted IMAP connection would be if your <strong>IMAP server</strong> and <strong>IMAP client</strong> were the same machine.</p><p><strong>Perform the following steps:</strong></p><ol><li>Let&#x27;s start by generating a new certificate for Dovecot <strong>on your vm3</strong> machine by issuing the following commands:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> /etc/ssl/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">private,certs</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -des3 -out vm3.andrewsmith.ops.key </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> vm3.andrewsmith.ops.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -key vm3.andrewsmith.ops.key -out vm3.andrewsmith.ops.csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -req -days </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> -in vm3.andrewsmith.ops.csr -signkey vm3.andrewsmith.ops.key -out vm3.andrewsmith.ops.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa -in vm3.andrewsmith.ops.key -out vm3.andrewsmith.ops.key.nopass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> vm3.andrewsmith.ops.key.nopass vm3.andrewsmith.ops.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -x509 -extensions v3_ca -keyout cakey.pem -out cacert.pem -days </span><span class="token number" style="color:#36acaa">3650</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> vm3.andrewsmith.ops.key cakey.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> vm3.andrewsmith.ops.key cakey.pem /etc/ssl/private</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> vm3.andrewsmith.ops.crt cacert.pem /etc/ssl/certs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>NOTE</strong>: This process is identical to what you&#x27;ve done for the vm2 certificate. In fact if your IMAP and SMTP servers are on the same machine you can share the certificate between them. In our case, they are not on the same machine.</li></ul><ol start="2"><li>Next, we need to configure Dovecot to use this for encrypted connections and not allow any kind of plain text connections. Edit the <strong>10-auth.conf</strong>, and <strong>10-ssl.conf</strong> files and change the following settings (note: these parameters already exist in those files, just find them and set them to the correct value):</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> required</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssl_cert </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> path_to_your_crt_file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssl_key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> path_to_your_key_file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disable_plaintext_auth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Now, we will disable normal imap connections, leaving only imaps (secured imap) allowed. Edit the <strong>10-master.conf</strong> file and set the port number in <strong>inet_listener imap</strong> to <strong>0</strong>.</li><li>Your key/certificate doesn&#x27;t have a <strong>.pem</strong> extension but they are PEM-encoded files. You can confirm that using the <strong>file</strong> command. If you&#x27;re interested, learning more about configuring Dovecot for SSL, refer to the following documentation: <a href="http://wiki2.dovecot.org/SSL/DovecotConfiguration" target="_blank" rel="noopener noreferrer">Dovecot SSL configuration</a>.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="verifying-that-mail-messages-are-encrypted">Verifying that Mail Messages are Encrypted<a class="hash-link" href="#verifying-that-mail-messages-are-encrypted" title="Direct link to heading">​</a></h3><p><strong>Perform the following steps:</strong></p><ol><li><p>Use the <strong>ss</strong> command to confirm you&#x27;re only listening on the <strong>imaps</strong> port, and not the plain imap port.</p></li><li><p>Next, reconfigure your account settings in Thunderbird to use the <strong>SSL/TLS</strong> connection security with your IMAP server, leaving the password as <strong>Normal Password</strong>.</p><ul><li><strong>NOTE</strong>: When you send your test email, you will get another warning because you&#x27;re using a self-signed certificate on <strong>vm3</strong>. Make certain to authorize the exception.</li></ul></li></ol><p><strong>Record steps, commands, and your observations on this investigation in your OPS335 lab log-book</strong></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-2-configure-webmail-roundcube-mail-to-use-encryption">Investigation 2: Configure Webmail (Roundcube Mail) To Use Encryption<a class="hash-link" href="#investigation-2-configure-webmail-roundcube-mail-to-use-encryption" title="Direct link to heading">​</a></h2><p>In the investigation, we will modify the <strong>roundcube</strong> webmail application to make use of the encrypted connections the email servers provide, and to allow clients to connect to it using an encrypted connection (<strong>https</strong>).</p><p><img loading="lazy" alt="Roundcube Logo" src="data:image/png;base64,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" width="212" height="56" class="img_ev3q"></p><p>Roundcube webmail application Logo</p><p><img loading="lazy" alt="Roundcube Pic" src="/OPS335/assets/images/Roundcube-pic-5b3cd0bfce86f9fe714d5077e09440c8.png" width="993" height="706" class="img_ev3q"></p><p>Screencapture of <strong>roundcube</strong> webmail application running in order to send and receive mail messages via a web-browser.</p><p><strong>Perform the following steps on vm1:</strong></p><p>First, we will modify the webserver to use the encrypted connections the email servers are now providing</p><ol><li><p>Modify the roundcube configuration file so that the following parameters reflect the encrypted settings on the mail servers:</p><ul><li><strong>$config<!-- -->[<!-- -->&#x27;smtp_server&#x27;<!-- -->]</strong></li><li><strong>$config<!-- -->[<!-- -->&#x27;default_host&#x27;<!-- -->]</strong></li><li><strong>$config<!-- -->[<!-- -->&#x27;default_port&#x27;<!-- -->]</strong></li><li><strong>NOTE</strong>: The last two entries above refer to your IMAPS server</li></ul></li><li><p>You may wish to use the configuration tool in your Roundcube installer after making those changes. To do so, you will need to add</p><ul><li><strong>$config<!-- -->[<!-- -->&#x27;enable_installer&#x27;<!-- -->]<!-- --> = true;</strong></li><li>to your configuration file.</li></ul></li><li><p>Next, test if the roundcube webmail application is working by sending and receiving e-mail messages.</p></li></ol><p>Now that the webmail application is using an encrypted connection when communicating with the email servers, it is time to encrypt the client&#x27;s connection to the web server.</p><ol start="4"><li>First you need to generate a new certificate for apache <strong>on your vm1</strong> machine by issuing the following commands:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> /etc/ssl/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">private,certs</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -des3 -out vm1.andrewsmith.ops.key </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> vm1.andrewsmith.ops.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -key vm1.andrewsmith.ops.key -out vm1.andrewsmith.ops.csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -req -days </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> -in vm1.andrewsmith.ops.csr -signkey vm1.andrewsmith.ops.key -out vm1.andrewsmith.ops.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa -in vm1.andrewsmith.ops.key -out vm1.andrewsmith.ops.key.nopass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> vm1.andrewsmith.ops.key.nopass vm1.andrewsmith.ops.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -x509 -extensions v3_ca -keyout cakey.pem -out cacert.pem -days </span><span class="token number" style="color:#36acaa">3650</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> vm1.andrewsmith.ops.key cakey.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> vm1.andrewsmith.ops.key cakey.pem /etc/ssl/private</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> vm1.andrewsmith.ops.crt cacert.pem /etc/ssl/certs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>NOTE</strong>: This process is identical to what you&#x27;ve done for the other two certificates.</li></ul><ol start="5"><li>Install the <strong>mod_ssl</strong> package to allow apache to use ssl.</li><li>Add the following parameters to the apache configuration file:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SSLEngine on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SSLCertificateFile </span><span class="token string" style="color:#e3116c">&quot;absolute_path_to_the_.crt_file&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SSLCertificateKeyFile </span><span class="token string" style="color:#e3116c">&quot;abolute_path_to_the_.key_file&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="7"><li><p>Restart apache and modify your firewall to allow traffic to <strong>port 443</strong>.</p></li><li><p>Open a web-browser on your host and try to connect to <a href="https://vm1." target="_blank" rel="noopener noreferrer">https://vm1.</a>&lt;yourdomain<!-- -->&gt;<!-- -->.ops/webmail</p><ul><li>You should get a security exception similar to the one&#x27;s you saw with the email, and for the same reason (the site you are trying to contact has a self-signed certificate). Add the exception and login to access your email.</li><li>Send an email to ensure everything is functioning properly.</li></ul></li></ol><p><strong>Backup your VMs!:</strong> You MUST perform a <strong>full backup</strong> of ALL of your VMs whenever you complete your <strong>OPS335 labs</strong> or when working on your <strong>OPS335 assignments</strong>. You should be using the dump command, and you should use the Bash shell script that you were adviced to create in order to backup all of your VMs.</p><p><strong>Record steps, commands, and your observations on this investigation in your OPS335 lab log-book</strong></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="completing-the-lab">Completing The Lab<a class="hash-link" href="#completing-the-lab" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="online-submission">Online Submission<a class="hash-link" href="#online-submission" title="Direct link to heading">​</a></h3><p>Follow the instructions for lab 7 on blackboard.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exploration-questions">Exploration Questions<a class="hash-link" href="#exploration-questions" title="Direct link to heading">​</a></h2><ol><li><p>Briefly define the term <strong>TSL</strong>.</p></li><li><p>Briefly define the term <strong>SSL</strong>.</p></li><li><p>List the steps to setup Encryption for Postfix with TLS.</p></li><li><p>List the steps to setup Encryption for Dovecot with SSL.</p></li><li><p>List the steps to setup Encryption for the Thunderbird application.</p></li><li><p>Provide a brief description of the following terms as they relate to mail servers:</p><ul><li><strong>Open Relay</strong></li><li><strong>SPF</strong></li><li><strong>DKIM</strong></li></ul></li><li><p>How does a webmail application differ from using another MUA like Thunderbird?</p></li><li><p>List the additional Apache modules that are required in order to run the Roundcube web application?</p></li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Seneca-ICTOER/OPS335/tree/main/docs/A-Labs/lab7.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/OPS335/A-Labs/lab6"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lab 6</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/OPS335/A-Labs/lab8"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab 8</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#objective-and-preparation" class="table-of-contents__link toc-highlight">Objective and Preparation</a><ul><li><a href="#online-resources" class="table-of-contents__link toc-highlight">Online Resources</a></li></ul></li><li><a href="#investigation-1-generating-a-self-signed-certificate" class="table-of-contents__link toc-highlight">Investigation 1: Generating A Self-Signed Certificate</a><ul><li><a href="#encrypting-postfix-with-transport-layer-security-tls" class="table-of-contents__link toc-highlight">Encrypting Postfix with Transport Layer Security (TLS)</a></li><li><a href="#setting-up-and-testing-encryption-with-thunderbird" class="table-of-contents__link toc-highlight">Setting Up and Testing Encryption with Thunderbird</a></li><li><a href="#encryption-dovecot-with-secure-socket-layer-ssl" class="table-of-contents__link toc-highlight">Encryption Dovecot with Secure Socket layer (SSL)</a></li><li><a href="#verifying-that-mail-messages-are-encrypted" class="table-of-contents__link toc-highlight">Verifying that Mail Messages are Encrypted</a></li></ul></li><li><a href="#investigation-2-configure-webmail-roundcube-mail-to-use-encryption" class="table-of-contents__link toc-highlight">Investigation 2: Configure Webmail (Roundcube Mail) To Use Encryption</a></li><li><a href="#completing-the-lab" class="table-of-contents__link toc-highlight">Completing The Lab</a><ul><li><a href="#online-submission" class="table-of-contents__link toc-highlight">Online Submission</a></li></ul></li><li><a href="#exploration-questions" class="table-of-contents__link toc-highlight">Exploration Questions</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">OPS335 - Open System Application Server</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/OPS335/">Contents</a></li><li class="footer__item"><a href="#" id="pwa-button" class="footer__link-item" hidden>Install as an App</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Seneca College.</div></div></div></footer></div>
<script src="/OPS335/assets/js/runtime~main.78245959.js"></script>
<script src="/OPS335/assets/js/main.293728ce.js"></script>
</body>
</html>